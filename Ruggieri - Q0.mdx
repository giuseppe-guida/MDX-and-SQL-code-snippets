-- Q0a: sales by quarter and customer city in absolute value
WITH		
	MEMBER Sales AS COALESCEEMPTY(([Measures].[Sales Amount]), 0), FORMAT_STRING = '$#,##0;$-#,##0;$0'
SELECT
	{ (DESCENDANTS( [Order Date].[Date H].[Year].&[2012], [Order Date].[Date H].[Quarter] ) ) } on columns,
	Filter ( { [Customer].[City].[City].MEMBERS }, ([Sales]) > 10000) on rows
FROM [Adventure Works DW2014]
WHERE { Sales }

--improvement  -- correggere inserendo nel filtro la dimensione date
WITH		
	MEMBER Sales AS COALESCEEMPTY(( [Measures].[Sales Amount] ), 0), FORMAT_STRING = '$#,##0;$-#,##0;$0'
SELECT
	{ (DESCENDANTS( [Order Date].[Date H].[Year].&[2012], [Order Date].[Date H].[Quarter] ) ) } on columns,
	Filter ( { [Customer].[City].[City].MEMBERS }, ([Measures].[Sales Amount]) > 10000) on rows
FROM [Adventure Works DW2014]
WHERE { [Measures].[Sales Amount] }


SELECT
     {[Measures].[Sales Amount]} ON COLUMNS,
     {Filter (
         [Customer].[City].[City].MEMBERS,
         ([Measures].[Sales Amount]) > 46936)
      } ON ROWS
FROM
    [Adventure Works DW2014]