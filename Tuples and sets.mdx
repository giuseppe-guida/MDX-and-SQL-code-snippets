--Tuples and sets

select
[Product].[Product Model Lines].[Product Line] on columns,
[Order Date].[Date H].[Year].&[2012].CHILDREN on rows --it works well als oby using the member name, in this case equal to the key .[2012]
from [Adventure Works DW2014]
where { [Measures].[Sales Amount]  };



with 
	SET test_set AS 'DESCENDANTS( [Order Date].[Date H].[Year].&[2012], [Order Date].[Date H].[English Month Name])'
	SET ordered_lines AS 
		ORDER (
			[Product].[Product Model Lines].[Product Line].Members,
			[Product].[Product Model Lines].CurrentMember.Member_Name, ASC
		)
select
	ordered_lines on columns,
	test_set on rows
from [Adventure Works DW2014]
where { [Measures].[Sales Amount] };



with set test_set AS 'DESCENDANTS( [Order Date].[Date H].[Year].&[2012], [Order Date].[Date H].[English Month Name])'
select
	[Product].[Product Model Lines].[Product Line] on columns,
	ORDER ( 
		test_set,
		test_set.CurrentMember.Member_Name, ASC
	) on rows
from [Adventure Works DW2014]
where { [Measures].[Sales Amount]  };



SELECT
	{ ([Order Date].[Semester].[All]), ([Order Date].[Semester].&[2]&[2012]) } on rows, 
	{ [Measures].[Sales Amount], [Measures].[Order Quantity] } on columns
FROM [Adventure Works DW2014];



WITH MEMBER total AS ( [Measures].[Sales Amount], [Order Date].[Semester].[All]), FORMAT_STRING = '$#,##0;-$#,##0;0'
	MEMBER one_sem AS ( [Measures].[Sales Amount], [Order Date].[Semester].&[2]&[2012] ), FORMAT_STRING = '$#,##0;-$#,##0;\Z\e\r\o'
	MEMBER perc AS ( one_sem / total ), FORMAT_STRING = 'percent'
select
	{ [Product].[Product Line].[Product Line] } on rows, 
	{ total, one_sem, perc } on columns
FROM [Adventure Works DW2014];


--excercise - use current memeber to browse the cube regardless the dimensions
WITH 
	MEMBER total AS ( {[Measures].[Sales Amount], [Order Date].[Date H].CurrentMember} ), FORMAT_STRING = '$#,##0;-$#,##0;0'
	MEMBER sem1 AS ( [Measures].[Sales Amount], [Order Date].[Date H].[Semester].&[1]&[2012] ), FORMAT_STRING = '$#,##0;-$#,##0;\Z\e\r\o'
	MEMBER sem2 AS ( [Measures].[Sales Amount], [Order Date].[Date H].[Semester].&[2]&[2012] ), FORMAT_STRING = '$#,##0;-$#,##0;\Z\e\r\o'
	MEMBER perc1 AS ( sem1 / total ), FORMAT_STRING = 'percent'
	MEMBER perc2 AS ( sem2 / total ), FORMAT_STRING = 'percent'
select
	{ [Product].[Product Line].[Product Line] } on rows, 
	{ total, sem1, sem2, perc1, perc2 } on columns
FROM [Adventure Works DW2014]
WHERE { ([Order Date].[Year].&[2012]) };


--non empty
WITH 
	MEMBER sem1 AS ( [Measures].[Sales Amount], [Order Date].[Date H].[Semester].&[1]&[2012] ) 
		, FORMAT_STRING = '$#,##0;-$#,##0;\Z\e\r\o'
	MEMBER empt AS IIF( IsEmpty(sem1), 0 , 1) 
select
	Non Empty { [Product].[Product Line].[Product Line] } on rows, 
	{ sem1 } on columns
FROM [Adventure Works DW2014]
WHERE { ([Order Date].[Year].&[2012]) };


--empty to zero
WITH 
	MEMBER sem1 AS ( [Measures].[Sales Amount], [Order Date].[Date H].[Semester].&[1]&[2012] ) 
	MEMBER nonZero AS IIF( ISEMPtY(sem1), 0, sem1 ), FORMAT_STRING = '$#,##0'
select
	{ [Product].[Product Line].[Product Line] } on rows,
	{ nonZero } on columns
FROM [Adventure Works DW2014]
WHERE { ([Order Date].[Year].&[2012]) }

